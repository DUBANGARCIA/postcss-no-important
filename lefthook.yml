pre-commit:
  parallel: false
  jobs:
    - run: mise trust
    - run: mise install --yes
    - run: eval "$(mise env)"
  commands:
    format:
      priority: 1
      glob: '*'
      run: bun --bun biome format --write --no-errors-on-unmatched --files-ignore-unknown=true {staged_files}
      stage_fixed: true
    lint:
      priority: 2
      glob: '*'
      run: bun --bun biome lint --write --unsafe --no-errors-on-unmatched --files-ignore-unknown=true {staged_files}
      stage_fixed: true
    sort-package-json:
      priority: 3
      glob: '**/package.json'
      run: bun sort-package-json {staged_files}
      stage_fixed: true
    toml:
      priority: 4
      glob: '*.toml'
      run: bun --bun taplo fmt {staged_files}
      stage_fixed: true
    actionlint:
      priority: 2
      glob: '.github/workflows/*.{yml,yaml}'
      run: actionlint {staged_files}

commit-msg:
  parallel: false
  jobs:
    - run: mise trust
    - run: mise install --yes
    - run: eval "$(mise env)"
  commands:
    commitlint:
      run: bun --bun commitlint --config commitlint.config.js --edit "$1"

post-checkout, post-merge, post-rewrite:
  parallel: false
  jobs:
    - run: mise trust
    - run: mise install --yes
    - run: eval "$(mise env)"
  commands:
    bun-install:
      glob: "{package.json,bun.lock,bunfig.toml}"
      run: bun install --frozen-lockfile
      only:
        - changed
